<!DOCTYPE html>
<html lang="ru">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Моделирование Системы</title>
		<link
			href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500&display=swap"
			rel="stylesheet"
		/>
		<link
			rel="stylesheet"
			href="{{ url_for('static', filename='style.css') }}"
		/>
	</head>
	<body>
		<header>
			<h1>Моделирование и Анализ Системы</h1>
		</header>

		<div class="main-container">
			<div class="content-block" id="variablesBlock">
				<h2>Параметры Модели (L<sub>i</sub>)</h2>
				<table class="var-table" id="variablesTable">
					<thead>
						<tr>
							<th>Название переменной (L<sub>i</sub>)</th>
							<th>Начальное значение</th>
							<!-- Предельное и Минимальное пока не используем в расчетах, но оставим для вида -->
							<th>Предельное значение</th>
							<th>Минимальное значение</th>
						</tr>
					</thead>
					<tbody>
						<!-- Строки для L1-L14 будут добавлены JS -->
					</tbody>
				</table>
			</div>

			<div class="content-block" id="fFunctionsBlock">
				<h2>Внутренние Функции (f<sub>i</sub>)</h2>
				<p>
					Полиномы вида: c<sub>3</sub>x<sup>3</sup> + c<sub>2</sub>x<sup>2</sup>
					+ c<sub>1</sub>x + c<sub>0</sub>. Вводите коэффициенты c<sub>3</sub>,
					c<sub>2</sub>, c<sub>1</sub>, c<sub>0</sub>.
				</p>
				<table class="func-table" id="fFunctionsTable">
					<thead>
						<tr>
							<th>Функция</th>
							<th>Коэф. c<sub>3</sub> (при x<sup>3</sup>)</th>
							<th>Коэф. c<sub>2</sub> (при x<sup>2</sup>)</th>
							<th>Коэф. c<sub>1</sub> (при x)</th>
							<th>Коэф. c<sub>0</sub> (свободный член)</th>
						</tr>
					</thead>
					<tbody>
						<!-- Строки для f1-f151 будут добавлены JS -->
					</tbody>
				</table>
			</div>

			<div class="content-block" id="zFunctionsBlock">
				<h2>Внешние Функции (z<sub>i</sub>)</h2>
				<p>
					Полиномы вида: c<sub>3</sub>t<sup>3</sup> + c<sub>2</sub>t<sup>2</sup>
					+ c<sub>1</sub>t + c<sub>0</sub>. Вводите коэффициенты c<sub>3</sub>,
					c<sub>2</sub>, c<sub>1</sub>, c<sub>0</sub>.
				</p>
				<table class="func-table" id="zFunctionsTable">
					<thead>
						<tr>
							<th>Функция</th>
							<th>Коэф. c<sub>3</sub> (при t<sup>3</sup>)</th>
							<th>Коэф. c<sub>2</sub> (при t<sup>2</sup>)</th>
							<th>Коэф. c<sub>1</sub> (при t)</th>
							<th>Коэф. c<sub>0</sub> (свободный член)</th>
						</tr>
					</thead>
					<tbody>
						<!-- Строки для z1-z5 будут добавлены JS -->
					</tbody>
				</table>
			</div>

			<div class="content-block" id="generationParamsBlock">
				<h2>Параметры Проверки и Генерации Внутренних Функций f<sub>i</sub></h2>
				<p>
					Если введенные коэффициенты для f<sub>i</sub> не проходят проверку на
					неотрицательность, сервер попытается найти подходящие случайные
					коэффициенты.
				</p>
				<div class="form-grid">
					<div>
						<label for="poly_output_lower_bound"
							>Нижняя граница для значения f<sub>i</sub> (>=):</label
						>
						<input
							type="number"
							id="poly_output_lower_bound"
							value="0"
							step="0.001"
						/>
					</div>
					<div>
						<label for="max_iterations_coeff_search"
							>Макс. итераций поиска коэфф. f<sub>i</sub> (если нужны
							случайные):</label
						>
						<input
							type="number"
							id="max_iterations_coeff_search"
							value="100000"
							min="10"
						/>
					</div>
					<div>
						<label for="internal_coeff_min_random"
							>Мин. значение для случайного коэфф. f<sub>i</sub>:</label
						>
						<input
							type="number"
							id="internal_coeff_min_random"
							value="0"
							step="0.1"
						/>
					</div>
					<div>
						<label for="internal_coeff_max_random"
							>Макс. значение для случайного коэфф. f<sub>i</sub>:</label
						>
						<input
							type="number"
							id="internal_coeff_max_random"
							value="0.2"
							step="0.1"
						/>
					</div>
				</div>
				<h4>
					Диапазон проверки значений внутренних полиномов
					f<sub>i</sub>(L<sub>j</sub>)
				</h4>
				<div class="form-grid">
					<div>
						<label for="internal_poly_check_range_min"
							>Мин. значение аргумента L<sub>j</sub> для проверки:</label
						>
						<input
							type="number"
							id="internal_poly_check_range_min"
							value="0.0"
							step="0.1"
						/>
					</div>
					<div>
						<label for="internal_poly_check_range_max"
							>Макс. значение аргумента L<sub>j</sub> для проверки:</label
						>
						<input
							type="number"
							id="internal_poly_check_range_max"
							value="1.0"
							step="0.1"
						/>
					</div>
					<div>
						<label for="internal_poly_check_granularity"
							>Кол-во точек на диапазоне проверки f<sub>i</sub>:</label
						>
						<input
							type="number"
							id="internal_poly_check_granularity"
							value="5"
							min="2"
						/>
					</div>
				</div>
			</div>

			<div class="control-buttons">
				<button id="fillRandomButton">Заполнить случайными значениями</button>
				<button id="calculateButton" class="action-button">Рассчитать</button>
			</div>

			<div class="results-section" id="resultsArea" style="display: none">
				<h2 style="text-align: center">Результаты</h2>
				<p id="statusMessage" class="status"></p>
				<div class="image-display">
					<img
						id="mainPlot"
						src=""
						alt="Основной график модели"
						style="display: none"
					/>
				</div>
				<div id="coeffsInfo" class="coeffs-display"></div>
			</div>
		</div>

		<script>
			// Переменные из Python для JS
			const NUM_L_VARIABLES = 14; // L1-L14
			const NUM_F_FUNCTIONS = {{ NUM_INTERNAL_POLYNOMIALS }}; // f1-f151
			const NUM_Z_FUNCTIONS = {{ NUM_EXTERNAL_Q_POLYNOMIALS }}; // z1-z5 (бывшие q_coeffs)
			// Названия переменных L_i (можно расширить, если есть конкретные)
			const L_VARIABLE_NAMES = [
			    "Эффективность функционирования хранилища данных", "Качество программного обеспечения (ПО)",
			    "Корректность ПО", "Надежность программного обеспечения", "Доступность программного обеспечения",
			    "Возможность интенсивного использования ПО", "Прослеживаемость ПО", "Функциональная полнота ПО",
			    "Обеспечение требуемой последовательности работ при проектировании хранилища", "Практичность ПО",
			    "Устойчивость к ошибкам данных программного обеспечения", "Эффективность выполнения транзакций",
			    "Степень мотивации персонала, осуществляющего эксплуатацию хранилища данных", "Удобство тестирования ПО"
			];
		</script>
		<script src="{{ url_for('static', filename='script.js') }}"></script>
	</body>
</html>
